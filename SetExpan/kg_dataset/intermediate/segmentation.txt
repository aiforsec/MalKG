<phrase>Microsoft Word</phrase> - <phrase>Aurora</phrase> <phrase>Botnet</phrase> <phrase>Command Structure</phrase> CLEAN _2010-03-04 JLD_
<phrase>docx</phrase> Take Back Command-and-Control The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> <phrase>History</phrase>, Patterns and Findings Executive Overview Following the <phrase>public</phrase> disclosures of <phrase>electronic</phrase> attacks <phrase>launched</phrase> against <phrase>Google</phrase> and several other businesses, subsequently referred to as Operation <phrase>Aurora</phrase>, Damballa conducted detailed analysis to confirm that existing customers were already <phrase>protected</phrase> and to ascertain the sophistication of the <phrase>criminal operators</phrase> behind the <phrase>botnet</phrase>
There has been much <phrase>media</phrase> attention and <phrase>speculation</phrase> as to the <phrase>nature</phrase> of the attacks
Multiple publications have <phrase>covered</phrase> individual aspects of the threat in particular detailed analysis of forensically recovered <phrase>malware</phrase> and explanations of the <phrase>Advanced Persistent Threat</phrase> (APT)
By contrast, Damballa has been able to compile an extensive timeline of the attack dating back to mid-2009 that identifies unique aspects to the <phrase>Aurora</phrase> <phrase>botnet</phrase> that have been previously unknown
Based upon this new <phrase>information</phrase> and our experience in dealing with thousands of enterprise-targeted botnets, Damballa believes that the <phrase>criminal operators</phrase> behind the attack are relatively unsophisticated compared other <phrase>professional</phrase> <phrase>botnet</phrase> operators
Even so, the <phrase>results</phrase> proved just as damaging as a sophisticated <phrase>botnet</phrase> since the threat was not quickly identified and neutralized
Key observations discussed in the main body of this analysis report:The <phrase>major</phrase> pattern of attacks previously identified as occurring in mid-December 2009 targeting <phrase>Google</phrase> appear to originate in July 2009 from <phrase>mainland China</phrase>
Hosts compromised with <phrase>Aurora</phrase> <phrase>botnet</phrase> agents and rallied to the <phrase>botnet</phrase> Command-and-Control (CnC) channels were distributed across multiple countries before the <phrase>public</phrase> disclosure of <phrase>Aurora</phrase>, with the top five countries being the <phrase>United States</phrase>, <phrase>China</phrase>, <phrase>Germany</phrase>, <phrase>Taiwan</phrase> and the <phrase>United Kingdom</phrase>
Damballa identified additional <phrase>botnet</phrase> CnC domains used by these <phrase>criminal operators</phrase> and established a timeline of <phrase>malware</phrase> associations back to May 2nd 2009 by tracking the <phrase>evolution</phrase> of the <phrase>malware</phrase> used by Auroras operators
 Analysis of network traffic associated with the lookups of the <phrase>botnet</phrase> CnC is not consistent with the publicly discussed <phrase>Internet Explorer 6</phrase> <phrase>infection</phrase> <phrase>vector</phrase>
 This <phrase>botnet</phrase> has a simple command <phrase>topology</phrase> and makes extensive use of <phrase>Dynamic DNS</phrase> (DDNS) CnC techniques
The <phrase>construction</phrase> of the <phrase>botnet</phrase> would be classed as old-<phrase>school</phrase>, and is rarely used by <phrase>professional</phrase> <phrase>botnet</phrase> <phrase>criminal operators</phrase> any more
Reliance upon DDNS CnC is typically associated with new and <phrase>amateur</phrase> <phrase>botnet</phrase> operators The criminals behind the <phrase>Google</phrase> attack appear to have built and managed a number of separate botnets and run a series of targeted attack campaigns in parallel
This conclusion is based upon CnC domain registration and <phrase>management</phrase> <phrase>information</phrase>
The earliest of the CnC domains associated with these botnets, reliant upon DDNS service provisioning, appear to have been registered on July 13th 2009
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 2 The <phrase>botnet</phrase> operators had access to large numbers of CnC hosts in geographically diverse hosting co-locations from the very start a fairly <phrase>high</phrase> cost for a <phrase>botnet</phrase>
Further, the <phrase>botnet</phrase> employed over a dozen domains in diverse DDNS networks for CnC
Some of the <phrase>botnet</phrase> agents focused on victims outside of <phrase>Google</phrase>, suggesting that each domain might have been dedicated to a distinct class or vertical of victims
 Only the US victims of the attack were compelled to perform <phrase>mail</phrase>-based DNS queries an event that would typically indicate attempted document exfiltration via <phrase>email</phrase> services
 Damballa identified multiple CnC testing, deployment, <phrase>management</phrase> and shutdown phases of the <phrase>botnet</phrase> CnC channels
Some of the CnC domains appear to have become dormant for a <phrase>period</phrase> of time after they infected victim systems
This type of activity can sometimes be associated with an update to the <phrase>botnet</phrase> <phrase>malware</phrase>, or when the criminal operator sells/trades a segment of the <phrase>botnet</phrase> to another criminal operator
 The <phrase>botnet</phrase> operators behind the <phrase>Aurora</phrase> attacks deployed other <phrase>malware</phrase> families prior to the key <phrase>Trojan</phrase>
Hydraq release
Some of these releases overlapped with each other
Two additional families of <phrase>malware</phrase> (and their <phrase>evolutionary</phrase> variants) were identified as Fake AV Alert / <phrase>Scareware</phrase> Login <phrase>Software</phrase> 2009 and Fake <phrase>Microsoft</phrase> Antispyware Service, both of which employed fake <phrase>antivirus</phrase> <phrase>infection</phrase> messages to socially <phrase>engineer</phrase> victims into installing malicious <phrase>botnet</phrase> agents
By studying the <phrase>evolution</phrase> of the <phrase>Google</phrase> attacks and tracking the malicious campaigns conducted before (and in parallel to) the <phrase>public</phrase> disclosure of Operation <phrase>Aurora</phrase> in January 2010, Damballa has established a detailed timeline of infections
Instead of this attack being a sophisticated APT operation, it appears that the attacks originated from a <phrase>Chinese</phrase> <phrase>botnet</phrase> operations team, and that the attack <phrase>vector</phrase> underwent several different phases of <phrase>botnet</phrase> building and <phrase>malware</phrase> deployment before being discovered by <phrase>Google</phrase>
The fact that some of the later attacks utilized a different <phrase>family</phrase> of <phrase>malware</phrase> and may have exploited <phrase>Zero-Day</phrase> vulnerabilities within <phrase>Internet Explorer 6</phrase> as one of the <phrase>infection</phrase> vectors is typical for modern <phrase>botnet</phrase> distribution campaigns
<phrase>Botnet</phrase> operators also increasingly <phrase>trade</phrase> or sell segments of the botnets they build
Once sold, the owner of the <phrase>botnet</phrase> typically deploys a new suite of <phrase>malware</phrase> onto compromised systems
The CnC provides the link between various campaigns run by the <phrase>botnet</phrase> operators and the multiple <phrase>malware</phrase> iterations
Since Damballa focuses on malicious, remote- controlled crimeware that depends on CnC to <phrase>function</phrase>, we were able to determine the <phrase>evolution</phrase> and sophistication of the <phrase>Aurora</phrase> <phrase>botnet</phrase> and its operators with greater detail and accuracy than other reports to-date
In <phrase>general</phrase>, <phrase>Aurora</phrase> is just another <phrase>botnet</phrase> and typifies the advanced <phrase>nature</phrase> of the threat and the criminal <phrase>ecosystem</phrase> that supports it
It is important to note, however, that botnets linked to the <phrase>criminal operators</phrase> behind <phrase>Aurora</phrase> may have been sold or traded to other <phrase>botnet</phrase> operators, either in sections or on an individual victim basis
This kind of transaction is increasingly popular
Specialist <phrase>botnet</phrase> builders sell access to victim systems or networks for a fee making it very simple for other entities to access confidential <phrase>business</phrase> systems and <phrase>information</phrase> without needing be technologically proficient
These transactions between criminals are very difficult to detect
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> <phrase>Page 3</phrase> Introduction The progression of semi-autonomous <phrase>malware</phrase> into globe-spanning botnets with victims numbering in the millions continues to accelerate
In <phrase>short</phrase>, botnets, and the criminal <phrase>ecosystem</phrase> that supports them, lie at the <phrase>heart</phrase> of modern <phrase>cybercrime</phrase>
Specialist contractors and <phrase>service providers</phrase> occupy every online niche, enabling both <phrase>newbie</phrase> hackers and <phrase>professional</phrase> <phrase>botnet</phrase> operators to overcome technological hurdles and operational barriers for a small price typically <phrase>stolen</phrase> identities or access to hijacked systems rather than dollars
All it takes to get started is an <phrase>Internet</phrase> search <phrase>engine</phrase> and the ability to install <phrase>software</phrase> on a computer
Devastating attacks start with a nominal fee for acquiring advanced <phrase>malware</phrase> <phrase>construction</phrase> tools capable of automatically generating customized <phrase>botnet</phrase> agents dramatically <phrase>superior</phrase> to tools used by <phrase>professional</phrase> hackers only three years ago
Fierce competition within the <phrase>ecosystem</phrase> has resulted in the commoditization of these tools and services, which has lowered price points and driven suppliers to differentiate with 24x7 support, <phrase>money</phrase>-back guarantees, replacement warrantees and even SLAs
<phrase>Major</phrase> international corporations have begun to publicly acknowledge this <phrase>electronic</phrase> threat
On January 12, 2010, <phrase>Google</phrase> announced that it had been the victim of a targeted attack and had subsequently identified over 34 additional organizations that had similarly been breached by the same criminal team
One <phrase>major</phrase> <phrase>industrial</phrase> powerhouse has publicly focused on the risks posed by persistent <phrase>electronic</phrase> attacks by including references to these threats in their quarterly 10-K filing
<phrase>Report</phrase> Objectives The purpose of this <phrase>report</phrase> is to explain the advanced <phrase>state</phrase> of todays <phrase>botnet</phrase> <phrase>ecosystem</phrase> by way of example, and to examine the ways in which <phrase>criminal operators</phrase> rely upon <phrase>botnet</phrase> technologies to breach corporate networks and extract secrets from their victims
Much <phrase>media</phrase> fervor has surrounded Googles <phrase>public</phrase> disclosure of the successful attacks against their systems
33 other victims also <phrase>fell</phrase> prey to what has been frequently referred to as an <phrase>Advanced Persistent Threat</phrase> (APT)
This <phrase>report</phrase> closely examines the methods employed by the <phrase>criminal operators</phrase> who conducted this <phrase>botnet</phrase> campaign
Many <phrase>security</phrase> vendors have explained the operation against <phrase>Google</phrase>, dubbed Operation <phrase>Aurora</phrase>, using a <phrase>military</phrase> <phrase>vernacular</phrase>
However, based upon analysis of exhaustive <phrase>data</phrase> surrounding these attacks and examination of both the <phrase>malware</phrase> and the CnC <phrase>topologies</phrase> used by the criminals behind <phrase>Aurora</phrase>, it appears that this threat can best be classified as a just another common <phrase>botnet</phrase> attack and one that is more <phrase>amateur</phrase> than <phrase>average</phrase>
This <phrase>report</phrase> details new analysis of the <phrase>malware</phrase> <phrase>evolution</phrase> and the CnC <phrase>construction</phrase> behind these attacks, and provides unique insight into similar threats facing large <phrase>business</phrase>
Comparisons are made between the <phrase>Aurora</phrase> attacks and professionally orchestrated campaigns run by sophisticated cyber criminals
Timelines <phrase>track</phrase> the <phrase>evolution</phrase> of this threat help to identify the objectives of the criminals behind the <phrase>Aurora</phrase> attacks, and illustrate the advanced <phrase>state</phrase> of the <phrase>botnet</phrase> <phrase>ecosystem</phrase>
Understanding <phrase>Aurora</phrase> <phrase>Malware</phrase> samples recovered from victim systems using <phrase>forensic</phrase> techniques lie at the <phrase>heart</phrase> of almost all <phrase>public</phrase> analysis of <phrase>Aurora</phrase>
The samples directly associated with <phrase>Aurora</phrase> are commonly referred to as <phrase>Trojan</phrase>
Hydraq
Damballa analyzed the <phrase>Trojan</phrase>
Hydraq outbreak using DNS monitoring logs obtained from CnC authority DNS servers
Since every infected host in the <phrase>Aurora</phrase> <phrase>botnet</phrase> contacted the The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 4 authority server, DNS logs provided a rich inventory of the botnets resolution behavior
The logs also delivered insights into the development, <phrase>gestation</phrase> and growth of the <phrase>Aurora</phrase> <phrase>botnet</phrase>
This <phrase>data</phrase> leads to several interesting questions: Origins Which network first resolved the <phrase>botnet</phrase> CnC domains? Who was the first victim? Are there clues in the first DNS lookups as to the authors or origin of the network? The analysis below shows that a <phrase>university</phrase> in <phrase>China</phrase>, and a <phrase>Chinese</phrase> <phrase>collocation</phrase> facility (<phrase>colo</phrase>), were critical early incubators of the <phrase>infection</phrase>
Portions of the <phrase>infection</phrase> originated from within <phrase>Google</phrase> <phrase>Chinas</phrase> offices
Remediation and Damage Assessment Who else resolved the <phrase>botnet</phrase> CnC domains before <phrase>news</phrase> of the <phrase>malware</phrase> became <phrase>public</phrase>? What were the victim systems forced to do? <phrase>Public</phrase> accounts <phrase>state</phrase> that the <phrase>botnet</phrase> harvested <phrase>email</phrase> <phrase>information</phrase>
The DNS log analysis reveals numerous <phrase>MX</phrase>-lookups (<phrase>mail</phrase>-related DNS lookups)
If these lookups are related to document <phrase>theft</phrase>, it is reasonable to estimate the number and timing of attempted exfiltration events
In addition to the type of DNS traffic, the log analysis also reveals where the victims are located
Almost all (99%) of these events took place inside Googles US network
No victim in any other <phrase>country</phrase> performed <phrase>MX</phrase> lookups, suggesting Auroras <phrase>data</phrase> exfiltration targets were all in the U
S
The pattern of <phrase>MX</phrase> lookups appears automated and lacks any <phrase>diurnal</phrase> properties
Capabilities What else does DNS log analysis suggest, and what other questions does it raise about the attack? Damballas analysis helps illumine the origin of the <phrase>botnet</phrase>, based on years of observing the authority servers used in the <phrase>Aurora</phrase> CnC
Previously Disclosed <phrase>Aurora</phrase> <phrase>Knowledge</phrase> Operation <phrase>Aurora</phrase> refers to the investigations of a <phrase>cyber attack</phrase> which appeared to have begun in mid- December 2009 and continued through to February 2010
<phrase>Aurora</phrase> was first publicly disclosed by <phrase>Google</phrase> on January 12, 2010 and is commonly associated with attacks originating from <phrase>China</phrase>
The <phrase>Aurora</phrase> name was originally publicized by Dmitri Alperovitch, <phrase>Vice President</phrase> of Threat <phrase>Research</phrase> at McAfee, and refers to a file path artifact that might reveal what the criminal authors of the <phrase>malware</phrase> named their operation
Key facts publicly associated with <phrase>Aurora</phrase>: a) <phrase>Google</phrase> stated that some of their <phrase>intellectual property</phrase> had been <phrase>stolen</phrase> and publicly announced the attack on January 12th 2010
b) While the scope of reported victims includes around 34 organizations, only <phrase>Google</phrase>, <phrase>Adobe Systems</phrase>, <phrase>Juniper Networks</phrase> and <phrase>Rackspace</phrase> have publicly confirmed that they were targeted
Various <phrase>media</phrase> reports have stated that <phrase>Yahoo</phrase>, <phrase>Symantec</phrase>, <phrase>Northrop Grumman</phrase>, <phrase>Dow Chemical</phrase> and the <phrase>Rand Corporation</phrase> were also among the targets
c) Many <phrase>security</phrase> agencies and experts claim the attack to be a sophisticated use of advanced tools and techniques most notably the use of a <phrase>Zero-Day</phrase> exploit for a previously unknown vulnerability in Microsofts <phrase>Internet Explorer 6</phrase> <phrase>browser</phrase> <phrase>technology</phrase>
d) The <phrase>public</phrase> name for the <phrase>malware</phrase> component that allowed the <phrase>Aurora</phrase> <phrase>criminal operators</phrase> to remotely control their victims system is called <phrase>Trojan</phrase>
Hydraq
<phrase>e</phrase>) The <phrase>Aurora</phrase> attacks are widely assumed to be an APT originating from within <phrase>China</phrase>
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 5 Advanced Persistent Threats Advanced Persistent Threats (APTs) are a <phrase>cybercrime</phrase> category <phrase>directed</phrase> at <phrase>business</phrase> and <phrase>political</phrase> targets
APTs require a <phrase>high</phrase> <phrase>degree</phrase> of stealithiness over a prolonged duration of operation in <phrase>order</phrase> to be successful
The attack objectives therefore typically extend beyond immediate financial gain, and compromised systems continue to be of service even after key systems have been breached and initial goals reached
Definitions of precisely what an APT is can vary widely, but can best be summarized by their named requirements: Advanced <phrase>Criminal operators</phrase> behind the threat utilize the full <phrase>spectrum</phrase> of computer intrusion technologies and techniques
While individual components of the attack may not be classed as particularly advanced (<phrase>e</phrase>
g
<phrase>malware</phrase> components generated from commonly available DIY <phrase>construction</phrase> kits, or the use of easily procured exploit materials), their operators typically access and develop more advanced tools as required
They combine multiple attack methodologies and tools in <phrase>order</phrase> to reach and compromise their <phrase>target</phrase>
Persistent <phrase>Criminal operators</phrase> give priority to a specific task, rather than opportunistically seeking immediate financial gain
This distinction implies that the attackers are guided by external entities
The attack is conducted through continuous monitoring and interaction of a <phrase>botnet</phrase> in <phrase>order</phrase> to achieve the defined objectives
It does not mean a barrage of constant attacks and <phrase>malware</phrase> updates
In fact, a low-and-slow approach is usually more successful
Threat Means that there is <phrase>a level</phrase> of coordinated <phrase>human</phrase> involvement in the attack
The <phrase>criminal operators</phrase> have a specific objective and are skilled, motivated, organized and well funded
Damballas Perspective Damballas <phrase>research</phrase> and technical expertise focuses on the detection of CnC <phrase>tethering</phrase> and the malicious communications between a victims computer and the remote criminal operator
Damballa detects new <phrase>botnet</phrase> CnC channels as they are created and used by <phrase>criminal operators</phrase>
This globe- spanning array of network sensors monitors CnC use to identify victims that join botnets
Damaballa used key DNS observations about the operational characteristics of <phrase>Dynamic DNS</phrase> zones (<phrase>e</phrase>
g
zone cuts, TTL changes, NS changes, etc
) in <phrase>order</phrase> to identify the different states in which the <phrase>botnet</phrase> was operated by its criminal controllers
Changes in the way that a DNS zone is structured by criminals typically denotes an <phrase>intension</phrase> to develop, <phrase>test</phrase>, and operate malicious <phrase>infrastructure</phrase>, or abandon a particular zone and move to a new one
Damballa also reviewed historical DNS resolution <phrase>data</phrase> derived from our passive observation systems to identify when (and how frequently) the CnC <phrase>domain names</phrase> associated with the <phrase>Aurora</phrase> <phrase>botnet</phrase> were queried
This <phrase>information</phrase> provided valuable insight into the pace at which victims rallied to the <phrase>botnet</phrase> and established a timeline for <phrase>Aurora</phrase>
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 6 Figure 1: Cumulative volume of CnC domain name resolutions
Absolute numbers do not represent individual victims (i
<phrase>e</phrase>
victim <phrase>computers</phrase> make repeated lookups based upon the TTL of the CnC domain and relative <phrase>malware</phrase> activity on the system), but do depict approximately when the CnC domains were first used by the <phrase>Aurora</phrase> <phrase>botnet</phrase>
From this passive DNS resolution dataset, that date appears to be June 14, 2009
These network observations combine with Damballas ability to identify <phrase>Zero-Day</phrase> remote access <phrase>malware</phrase> and <phrase>botnet</phrase> agents within customers networks to determine additional CnC relationships
<phrase>Zero-Day</phrase> <phrase>malware</phrase> samples are automatically passed to Damballas analysis <phrase>cloud</phrase> along with tens-of- thousands of new <phrase>malware</phrase> variants obtained through <phrase>industry</phrase> <phrase>security</phrase> sharing programs
These network behaviors are extracted, and provide Damballa with additional insight into CnC <phrase>evolution</phrase> and criminal ownership
They also allow us to cluster various <phrase>malware</phrase> and <phrase>botnet</phrase> agents automatically with their respective <phrase>criminal operators</phrase> despite factors such as serial variant <phrase>production</phrase>, migrations to new <phrase>malware</phrase> families and sub-contracting <phrase>malware</phrase> development to other criminal authors
<phrase>Trojan</phrase>
Hydraq is the name of a <phrase>family</phrase> of <phrase>malware</phrase> now synonymous with Operation <phrase>Aurora</phrase>
To date, only a handful of related samples have been made <phrase>public</phrase> by various <phrase>security</phrase> vendors almost all of which were gathered through <phrase>forensic</phrase> analysis of compromised <phrase>computers</phrase>
However, it is important to understand that not only are there multiple variants of <phrase>malware</phrase> within the <phrase>Trojan</phrase>
Hydraq <phrase>family</phrase>, but that <phrase>criminal operators</phrase> also use(d) other <phrase>malware</phrase> families in their attacks
Based upon analysis of samples and <phrase>data</phrase> gathered by Damballa, <phrase>malware</phrase> associated with the <phrase>criminal operators</phrase> behind the <phrase>Aurora</phrase> <phrase>botnet</phrase> can be traced back to August 2009
A holistic DNS <phrase>forensic</phrase> analysis of any <phrase>botnet</phrase> that utilizes DNS as a critical <phrase>communication</phrase> element requires DNS <phrase>information</phrase> from both the iterative and recursive DNS phases
Utilizing large scale passive DNS <phrase>information</phrase> from large <phrase>ISPs</phrase> and DNS traces from a significant portion of the CnCs DNS authority servers (ANS) Damballa has identified more than many infected hosts that attempted to connect or rally to the five CnC <phrase>domain names</phrase> associated with the <phrase>Aurora</phrase> <phrase>botnet</phrase> and investigated in this <phrase>report</phrase>
These hosts where distributed across multiple countries at the time of the <phrase>public</phrase> <phrase>Google</phrase> disclosure (January 12, 2010)
1 10 100 1000 10000 100000 1000000 7/1/2009 8/1/2009 9/1/2009 10/1/2009 11/1/2009 12/1/2009 1/1/2010 The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 7 Position <phrase>Country</phrase> 1 <phrase>United States</phrase> 2 <phrase>China</phrase> 3 <phrase>Germany</phrase> 4 <phrase>Taiwan</phrase> 5 <phrase>United Kingdom</phrase> Table 1: Top 5 countries with <phrase>Aurora</phrase> <phrase>botnet</phrase> victims Damballas passive DNS <phrase>data</phrase> collection indicates that the <phrase>infection</phrase> <phrase>vector</phrase> was not centralized, and that a significant number of infected assets tried to look up CnC <phrase>domain names</phrase> throughout the US, with a higher <phrase>frequency</phrase> in the Northeast
Figure 2: Volume of DNS queries per <phrase>Aurora</phrase> CnC domain associated with the attacks within the <phrase>USA</phrase>, by geographic <phrase>region</phrase> Some interesting observations can be made about the <phrase>lifetime</phrase> and popularity of the CnC domains used
The next figure shows that portions of the CnC <phrase>domain names</phrase> were active since the beginning of September 2009 (<phrase>e</phrase>
g
<phrase>google</phrase>
homelinux
com, <phrase>yahoo</phrase>
blogdns
net, mcsmc
org)
These <phrase>domain names</phrase> reveal two important trends a downward-spike during the month of October and a steady hit rate for the remaining months
Beside these <phrase>long</phrase>-lived CnC <phrase>domain names</phrase>, Damballa observed a number of <phrase>domain names</phrase> that become active in the early days of November
Some of them were active only for a couple of months (<phrase>e</phrase>
g
filoups
info), while others where active longer The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 8 (<phrase>e</phrase>
g
m7been
zapto
org, baltika1
servebeer
com, etc
) before they where sinkholed by corresponding DNS operators
Figure 3: Volume of DNS resolution queries per <phrase>Aurora</phrase> <phrase>botnet</phrase>, per month
Spikes in query volume typically indicate growth of a <phrase>botnet</phrase> and renewed CnC interaction
The <phrase>Major</phrase> Components Botnets are a <phrase>business</phrase>
<phrase>Professional</phrase> <phrase>criminal operators</phrase> employ specialist tools, services and methodologies to conduct their <phrase>botnet</phrase> operations
While <phrase>botnet</phrase> discussion has been tied <phrase>malware</phrase> families in the past (<phrase>e</phrase>
g
The <phrase>Conficker</phrase> <phrase>Botnet</phrase>, The Koobface <phrase>Botnet</phrase>), todays <phrase>botnet</phrase> operators regularly employ multiple families of <phrase>malware</phrase>, considering them disposable attack tools
The key elements of a <phrase>botnet</phrase> are: <phrase>Malware</phrase> The tool used by <phrase>botnet</phrase> operators to conduct malicious activities on victims <phrase>computers</phrase> and to provide <phrase>remote control</phrase> capabilities
CnC The <phrase>electronic</phrase> tether between the criminal operator, a control server and victims <phrase>computers</phrase>
CnC Domain The domain name of the host being used for CnC conduct or to route communications between the control server and the victims computer
CnC Server The server used by the <phrase>botnet</phrase> operators to rally and provide <phrase>electronic</phrase> tethers to victim <phrase>computers</phrase>
<phrase>Botnet</phrase> The collective name for <phrase>malware</phrase>-infected victims with established connections to a CnC server and remotely controlled by <phrase>criminal operators</phrase>
<phrase>Criminal Operators</phrase> The person or team that builds, manages and reaps financial reward from a <phrase>botnet</phrase>
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 9 How Advanced Persistent Threats Breach Enterprises APTs breach enterprises through a wide <phrase>variety</phrase> of vectors, even in the presence of properly designed and maintained defense-in-depth strategies: <phrase>Internet</phrase>-based <phrase>malware</phrase> <phrase>infection</phrase> Physical <phrase>malware</phrase> <phrase>infection</phrase> External exploitation Well funded APT adversaries do not necessarily need to breach perimeter <phrase>security</phrase> controls from an external perspective
They can, and often do, leverage insider threat and trusted connection vectors to access and compromise targeted systems
Abuse and compromise of trusted connections is a key ingredient for many APTs
While the targeted <phrase>organization</phrase> may employ sophisticated technologies in <phrase>order</phrase> to prevent <phrase>infection</phrase> and compromise of their <phrase>digital</phrase> systems, <phrase>criminal operators</phrase> often <phrase>tunnel</phrase> into an <phrase>organization</phrase> using the hijacked credentials of employees or <phrase>business</phrase> partners, or via less-secured remote offices
As such, almost any <phrase>organization</phrase> or remote site may fall victim to an APT and be utilized as a soft entry or <phrase>information</phrase> harvesting point
A key requirement for APTs (as opposed to an everyday <phrase>botnet</phrase>) is to remain invisible for as <phrase>long</phrase> as possible
As such, the <phrase>criminal operators</phrase> of APT technologies tend to focus on low and slow attacks stealthily moving from one compromised host to the next, without generating regular or predictable network traffic to hunt for specific <phrase>data</phrase> or system objectives
Tremendous effort is invested to ensure that malicious actions cannot be observed by legitimate operators of these systems
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 10 <phrase>Malware</phrase> is a key ingredient in successful APT operations
Modern off-the-shelf and commercial <phrase>malware</phrase> includes all of the features and functionality necessary to infect <phrase>digital</phrase> systems, hide from host-based detection systems, navigate networks, capture and extricate key <phrase>data</phrase>, provide <phrase>video</phrase> <phrase>surveillance</phrase> and deliver <phrase>silent</phrase> covert channels for <phrase>remote control</phrase>
APT operators often use custom <phrase>malware</phrase> tools to achieve specific objectives and harvest <phrase>information</phrase> from non-standard systems
At the very <phrase>heart</phrase> of every APT lies <phrase>remote control</phrase> functionality
<phrase>Criminal operators</phrase> need this capability in <phrase>order</phrase> to navigate to specific hosts within <phrase>target</phrase> organizations, exploit and manipulate local systems, and gain continuous access to critical <phrase>information</phrase>
If an APT cannot connect with its <phrase>criminal operators</phrase>, then it cannot transmit any <phrase>intelligence</phrase> it may have captured
In effect, it has been neutered
This characteristic makes APTs appear as a sub-category of botnets
While APT <phrase>malware</phrase> can remain stealthy at the host level, the network activity associated with <phrase>remote control</phrase> is more easily identified
As such, APTs are most effectively identified, contained and disrupted at the network level
Controlling the Victim Once the victims computer has been compromised, the <phrase>malware</phrase> component will typically establish its first CnC session to register itself with the <phrase>botnet</phrase> CnC server
In <phrase>order</phrase> for this to occur, the <phrase>botnet</phrase> operator must correctly set up the CnC servers and also configure appropriate resolution services such as registering <phrase>domain names</phrase> and configuring DNS resolution settings
Depending upon the sophistication of the <phrase>botnet</phrase> operators, this CnC <phrase>infrastructure</phrase> can take on many different forms, with each <phrase>alternative</phrase> offering varying degrees of robustness and flexibility
Readers are encouraged to read Damballas earlier whitepaper titled, <phrase>Botnet</phrase> <phrase>Communication</phrase> <phrase>Topologies</phrase>: Understanding the Intricacies of <phrase>Botnet</phrase> Command-and-Control, for more <phrase>information</phrase> on this topic
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 11 Detailed analysis of DNS intricacies for CnC domain name querying and <phrase>management</phrase> follow
Key Concepts: DNS Overview DNS resolution can be generally viewed as having two phases a <phrase>private</phrase> stub (or recursive) layer, and a <phrase>public</phrase> authoritative (or iterative) layer
Figure 4: Conceptual view of <phrase>Aurora</phrase> DNS lookups and multiple monitoring opportunities
Damballa used the convenience of an authority monitoring system to gather [<phrase>qr</phrase> aa] responses
The figure above illustrates how <phrase>Aurora</phrase> victims performed DNS lookups, and provides a simplified <phrase>delegation</phrase> <phrase>tree</phrase> for several of the <phrase>Aurora</phrase>-related CnC domains
An <phrase>Aurora</phrase> authority DNS zone is depicted: the <phrase>light</phrase> <phrase>blue zone</phrase> delegated to No-IP
The No-IP zone has been simplified in the diagram to include the authority DNS servers, nf[1-4]
no-ip
com, as well as the actual <phrase>Aurora</phrase> CnC domain, blog1
servebeer
com, even though in practice these are separate delegations from the
com <phrase>TLD</phrase> parent
An infected host is depicted in the <phrase>light</phrase> <phrase>green</phrase> <phrase>area</phrase>
Its resolution path consists of the <phrase>virus</phrase> code (designated as VX), a local stub resolver (often available through various statically named or random <phrase>DLL</phrase> files on <phrase>Windows</phrase> hosts), and a local recursive DNS server
The <phrase>private</phrase> portions of DNS traffic occur within this local envelope, colored as the <phrase>light</phrase> <phrase>green</phrase> <phrase>area</phrase>
No DNS monitoring takes place here, in part because of the possible presence of PII, and because of the staggering volume of traffic monitoring might entail, for even a small network
Such networks often generate billions of queries per day below the recursive
When a victim attempts to contact the <phrase>Aurora</phrase> CnC domain blog1
servebeer
com, it must first discover the <phrase>delegation</phrase> of the zone to the No-IP authority name servers
(To save space, these steps are not shown in the figure above)
The overall <phrase>delegation</phrase> of authority is shown in the figure as a <phrase>tree</phrase>
The hosts nf[1-4]
no-ip
com are the authorities for the CnC zone
Thus, the victim networks recursive server discovers these name servers, queries for the <phrase>Aurora</phrase> CnC domain, and caches the answer
<phrase>Dynamic DNS</phrase> and IP-Agility Botnets have used <phrase>Dynamic DNS</phrase> services (DDNS) for nearly 8 years
For the most part, the role of DDNS in <phrase>professional</phrase>, criminal botnets is historic
Concentrated cleanup efforts and a few well documented arrests have changed the class of botmaster using DDNS
For the most part, <phrase>professional</phrase> cyber criminals do not use DDNS for <phrase>botnet</phrase> <phrase>rallying</phrase>, since DDNS providers: The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 12 a) are generally responsive to <phrase>law</phrase> enforcement; b) keep logs; and c) a few are famously known to actively monitor and remediate their networks
Since 2007, most <phrase>professional</phrase> criminal <phrase>botnet</phrase> CnCs (<phrase>e</phrase>
g
, <phrase>Russian</phrase> <phrase>mafia</phrase>) have moved away from DDNS, because of the aggressive stance taken by the <phrase>major</phrase> DDNS providers against <phrase>botnet</phrase> abuse
While there has been a recent return of novice botmasters to the <phrase>free</phrase> DNS services, the <phrase>professional</phrase> criminal botmasters have largely moved on to more resilient, agile DNS technologies
For example, <phrase>professional</phrase> botnets buy tens of thousands of <phrase>domain names</phrase>, and use domain agility instead of the IP agility found in DDNS
The best example of this is <phrase>Conficker</phrase>
C
The decline in <phrase>professional</phrase> <phrase>botnet</phrase> use of DDNS services has been so dramatic that many <phrase>anti</phrase>-<phrase>botnet</phrase> researchers changed their focus to new areas of threat
The <phrase>average</phrase> botmaster still using DDNS is generally a novice, and the <phrase>malware</phrase> they <phrase>seed</phrase> on victim machines is often kit-generated
There are a few exceptions where <phrase>amateur</phrase> botmasters evolve into professionals, but the bulk of botnets relying upon DDNS remain novice efforts, and use only a few <phrase>domain names</phrase> with a <phrase>single</phrase> DDNS provider
The <phrase>Aurora</phrase> <phrase>botnet</phrase> uses DDNS and old <phrase>school</phrase> coordination techniques not used by sophisticated botmasters who have the means to purchase and manage dozens of <phrase>domain names</phrase>
And yet despite having the signature of a novice effort, it also used numerous different DDNS services
<phrase>Network Analysis</phrase> The <phrase>network analysis</phrase> in this <phrase>report</phrase> encompasses the CnC <phrase>domain names</phrase> known to be publicly associated with the <phrase>Aurora</phrase> attacks, plus an additional four non-<phrase>public</phrase> domains (<phrase>listed</phrase> below) which are related to the <phrase>criminal operators</phrase> behind the <phrase>Aurora</phrase> attacks through shared DDNS registration credentials and their synchronized <phrase>management</phrase>
Domain Authority Creation Date (<phrase>UTC</phrase>) CnC_Domain
1 December 15, 2009 CnC_Domain
2 December 15, 2009 CnC_Domain
3 July 13, 2009 CnC_Domain
4 December 15, 2009 blog1
servebeer
com December 15, 2009 Table 2: DDNS botnets with characteristics identical to the <phrase>Aurora</phrase> <phrase>botnet</phrase> and shared DDNS credentials
The first four of these CnC domains have been intentionally obscured
The DNS TTL <phrase>data</phrase> associated with these interlinked <phrase>Aurora</phrase> <phrase>domain names</phrase> reveals that there were different phases to their use
The figure below indicates when a particular CnC domain name was sinkholed or idle (i
<phrase>e</phrase>
not pointing to a specific <phrase>Internet</phrase> <phrase>IP address</phrase>, or pointing to a local <phrase>loopback</phrase> address such as 127
0
0
1), it was pointing at probable development <phrase>IP addresses</phrase> as the <phrase>criminal operators</phrase> experimented with their attack tools, such as when the CnC <phrase>domain names</phrase> were pointing at the <phrase>IP addresses</phrase> associated with two of the CnC servers used during the <phrase>Aurora</phrase> attack
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 13 Figure 5: CnC domain name transition changes as the attackers developed <phrase>botnet</phrase> attacks
Based upon passively obtained DNS resolution <phrase>data</phrase> from sensors scattered around the globe (but predominantly US based), Damballa observed that several key CnC domains resolved to different server <phrase>IP addresses</phrase> over the <phrase>period</phrase> of study
The transitions from one <phrase>IP address</phrase> to another can be used to identify the different phases of <phrase>botnet</phrase> development (<phrase>e</phrase>
g
as depicted in the figure above), as well as the <phrase>nature</phrase> of the CnC servers hosting and <phrase>botnet</phrase> <phrase>topology</phrase> (<phrase>e</phrase>
g
whether parts of the CnC network were using fast-<phrase>flux</phrase> services)
The table below lists the number of <phrase>IP address</phrase> changes to the CnC domain name resolution and is a <phrase>lower</phrase> bound number, since Damballa does not monitor all <phrase>Internet traffic</phrase>
CnC Domain Name Distinct <phrase>IP Addresses</phrase> baltika1
servebeer
com 50 m7been
zapto
org 50 miecros
info 4 mcsmc
org 3 <phrase>yahoo</phrase>
blogdns
<phrase>net 5</phrase> filoups
info 2 <phrase>google</phrase>
homeunix
com 2 Table 3: The number of distinct <phrase>IP addresses</phrase> observed by Damballa and associated with each of the CnC <phrase>domain names</phrase> for the <phrase>period</phrase> of August 2009 to the <phrase>Google</phrase> <phrase>Aurora</phrase> disclosure on January 12, 2010
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 14 Overview of CnC Domains Not all of the authority servers hosted by the DDNS providers for this <phrase>botnet</phrase> were monitored by Damballa and sampling practices were adopted for this analysis
In <phrase>general</phrase>, for large botnets, the sampling this produces is more than adequate to detect <phrase>professional</phrase> cyber criminal botnets
 Around 5,236 recursive DNS servers visiting the <phrase>Aurora</phrase> CnC authorities used BIND
The table below lists the <phrase>major</phrase> types
Damballa identified a signature specific to <phrase>Chinese</phrase> closed recursive DNS servers that provides policy insight to some selected resolvers
The table below provides counts of queries from recursive DNS servers for both <phrase>ISO-3166</phrase> <phrase>country code</phrase> and qtype
All <phrase>data</phrase> was gathered on or before January 11, 2010 (the <phrase>eve</phrase> of the <phrase>Google</phrase> <phrase>public</phrase> announcement) to avoid polluting queries from the press and researchers
It is estimated that <phrase>Google</phrase> discovered this attack in mid to late December, 2009, so some of the resolution traffic could be associated with their internal remediation
The table also demonstrates that only US victims were required to perform <phrase>MX</phrase> queries, hinting at <phrase>data</phrase> extraction via <phrase>SMTP</phrase> <phrase>mail</phrase> services
Query Type US <phrase>CN</phrase> Others 15 (<phrase>MX</phrase>) 143,015 0 0 1 (A) 52,787 644 676 28 (AAAA) 12,254 84 0 Table 4: Breakdown of qtype by <phrase>country code</phrase> of recursive, for all five studied <phrase>Aurora</phrase> <phrase>botnet</phrase> CnCs
Highlights: (a) Only the US victims were compelled to perform <phrase>MX</phrase> queries (qtype 15); all networks in <phrase>China</phrase> and other countries never performed an <phrase>MX</phrase> query; (b) No AAAA (qtype 28) queries were performed by international victims, who were presumably collateral victims; the pairing of AAAA to A queries is discussed below; and (c) Most queries were <phrase>MX</phrase> (68% overall), and the attack heavily biased towards the US (also 68 % overall)
CnC Domains over Time Damballas analysis of DNS <phrase>data</phrase> has revealed the very early origin (July 2009) of the <phrase>botnet</phrase>
Even during this early deployment, the <phrase>botnet</phrase> was widely <phrase>dispersed</phrase>
Since these were the first DNS resolutions for these attacks, it is reasonable to assume they are associated with the botmaster (<phrase>e</phrase>
g
, testing or configuring their attack), and not victims
Thus, these resolutions might correspond to several CnC sites
If this theory is correct, it suggests that, despite using naive DDNS services typical of novice <phrase>botnet</phrase> operators, the <phrase>Aurora</phrase> botmasters had considerable resources available to them
CnC_Domain
1 The first resolution for CnC_Domain
1 came from within <phrase>Google</phrase> <phrase>Chinas</phrase> offices
It was followed hours later by resolutions inside Googles offices in <phrase>Mountain View</phrase>, <phrase>California</phrase>
The pattern of lookups is remarkable, and is worth closer study
The first queries for CnC_Domain
1 were: 2009-12-16 05:26:44 AAAA (<phrase>Google</phrase> <phrase>China</phrase>) 2009-12-17 22:39:09 AAAA (<phrase>Google</phrase> <phrase>Mountain View</phrase>) 2009-12-17 22:39:09 A (<phrase>Google</phrase> <phrase>Mountain View</phrase>) The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 15 Counting Attempted Exfiltration Events Other patterns of DNS messages in CnC_Domain
1 suggest the attempted exfiltration of <phrase>data</phrase>
Consider this ordering of queries: 2009-12-18 06:29:09 <phrase>MX</phrase> (<phrase>Google</phrase> <phrase>Mountain View</phrase>) 2009-12-18 06:29:09 A (<phrase>Google</phrase> <phrase>Mountain View</phrase>) The queries both happen in under a second, indicating that a host using a recursive resolver wished to send <phrase>email</phrase> to the CnC_Domain
1 CnC (hence the <phrase>MX</phrase> lookup)
<phrase>Dynamic DNS</phrase> zones, however, almost never have valid <phrase>MX</phrase> RRsets, or if they do they are pointed to abuse@traps or spamtraps
Only a few DDNS providers offer <phrase>mail</phrase>, and the first query was therefore answered with an empty record (NOERROR status, with zero answers)
As a result, the victim immediately performed an A query, to use the <phrase>IP address</phrase> for <phrase>email</phrase>
Whether these queries were followed by actual or successful <phrase>email</phrase> events is not known
All <phrase>MX</phrase> queries in CnC_Domain
1 came from the <phrase>United States</phrase> (and no other network outside the US performed such a query before the <phrase>news</phrase> broke)
Before January 10th 2010, some 110,810 <phrase>MX</phrase> queries came from <phrase>Google</phrase> <phrase>Mountain View</phrase>, and one came from <phrase>Comcast</phrase> (<phrase>San Jose</phrase>)
This <phrase>Comcast</phrase>- based query may have been testing by a <phrase>Google</phrase> <phrase>security</phrase> <phrase>engineer</phrase>, or it may have been an <phrase>infection</phrase> on a notebook after work (since the query took place in the late evening hours, PST)
From the volume of messages, it is presumed that each <phrase>MX</phrase> query corresponds to a <phrase>single</phrase> <phrase>email</phrase> exfiltration attempt
It would be hard to imagine a botmaster being able to direct these events individually
Thus, it may not be the case that bots were instructed to <phrase>email</phrase> materials when a specific event took place
Or the consistent pattern of queries could be the result of persistent searches of a <phrase>hard drive</phrase>, and attempted, periodic exfiltration of any useful <phrase>data</phrase>
This conclusion is <phrase>speculation</phrase>
The lack of any <phrase>diurnal</phrase> pattern to these events does indicate that the trigger event for an <phrase>MX</phrase> lookup was not <phrase>human</phrase>-driven (<phrase>e</phrase>
g
, the arrival of <phrase>email</phrase> on a victim machine, or selected actions by the botmaster)
It is not known what <phrase>information</phrase> was taken, if any, or if these queries were in fact victim behavior
<phrase>Public</phrase> accounts from <phrase>Google</phrase> indicate that the attackers sought <phrase>email</phrase> records of <phrase>human rights</phrase> activists
It is speculated that <phrase>Google</phrase> would have prevented the direct-to-<phrase>MX</phrase> behavior of hosts within their network
That is, in many corporate networks, individual user machines are prohibited from sending <phrase>email</phrase> directly, and must instead use a smart host or authenticated relay system
Thus, these <phrase>MX</phrase> lookups may well be side effect of an unsuccessful exfiltration effort
The <phrase>malware</phrase> also used ports 443 and 8585 for CnC, and could be instructed to perform any command
CnC_Domain
3 The CnC_Domain
3 CnC domain is interesting because of its age
The <phrase>botnet</phrase> dates back to July 14, 2009, <phrase>fell</phrase> dormant for months, and then became active again within Googles network
Of the five CnC domains studied in detail within this <phrase>report</phrase>, this is the oldest, and most strongly suggests an origin for the <phrase>botnet</phrase>
The early queries for the <phrase>Aurora</phrase> CnC domain CnC_Domain
3 took place in the <phrase>HangZhou</phrase> <phrase>region</phrase>, with some occurring in <phrase>Beijing</phrase>
The domain had a remarkable number of queries from <phrase>mainland China</phrase> The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 16 and <phrase>collocation</phrase> facilities in the US within minutes of being created
Seconds later, another query came from Chinanets network in the <phrase>Chongqing</phrase> <phrase>area</phrase>
The close timing of these suggests the owners of CnC_Domain
3 had access to <phrase>ISP</phrase>, <phrase>university</phrase>, and commercial transit
2009-07-14 02:50:03 A (HiNet <phrase>Taiwan</phrase>) 2009-07-14 02:57:38 A (CHINANET <phrase>Jiangsu</phrase>) 2009-07-14 02:58:31 A (CHINANET <phrase>HangZhou</phrase>) 2009-07-14 03:03:11 A (<phrase>HangZhou</phrase> Institute of <phrase>Electronic</phrase> <phrase>Engineering</phrase>) 2009-07-14 03:03:44 A (CHINANET <phrase>Chongqing</phrase>) 2009-07-14 03:04:28 A (FDC Servers, US <phrase>Chicago</phrase>) 2009-07-14 03:13:18 A (Level 3, US <phrase>Washington</phrase>) The pattern of these lookups suggests that the <phrase>author</phrase> was performing testing, and had access to two different transits (<phrase>e</phrase>
g
, a <phrase>school</phrase> network and an <phrase>ISP</phrase>)
CnC_Domain
2 The first query for the CnC_Domain
2 domain came from Googles <phrase>Mountain View</phrase> recursive
2009-12-17 22:39:09 AAAA (<phrase>Google</phrase> <phrase>Mountain View</phrase>) 2009-12-18 06:27:58 <phrase>MX</phrase> (<phrase>Google</phrase> <phrase>Mountain View</phrase>) 2009-12-18 06:27:58 A (<phrase>Google</phrase> <phrase>Mountain View</phrase>) 2009-12-18 18:15:18 AAAA (<phrase>Comcast</phrase>; <phrase>San Jose</phrase>) 2009-12-18 18:15:18 A (<phrase>Comcast</phrase>; <phrase>San Jose</phrase>) 2009-12-18 18:15:18 <phrase>MX</phrase> (<phrase>Comcast</phrase>; <phrase>San Jose</phrase>) 2009-12-18 18:19:30 AAAA (<phrase>Google</phrase>-IT) 2009-12-18 18:19:30 A (<phrase>Google</phrase>-IT) The CnC_Domain
2 CnC domain is also notable because it witnessed queries from many other networks outside of <phrase>Google</phrase> before the <phrase>public</phrase> <phrase>news</phrase> broke
This domain has never been identified publicly as part of <phrase>Aurora</phrase>
Networks performing queries up to January 10, 2010 include numerous <phrase>ISPs</phrase>
Observed Loss of Queries When a <phrase>botnet</phrase> is remediated at the DNS level, the associated victims continue to query the authority DNS server
Unless and until the local network cleans the hosts or imposes network blocks, victim traffic to the authority will continue
A sudden loss of network traffic from a <phrase>country</phrase>, however, can be unusual, particularly where the victims are spread over disparate (heterogeneous policy) networks
That is, it is unlikely that many different networks would simultaneously remediate hosts
Thus, while it may seem likely that all victims in a <phrase>single</phrase> network disappear (<phrase>e</phrase>
g
, as when a network operator deploys a firewall rule), it is remarkable when all victims in diverse policy boundaries also disappear
Such centralized control speaks to the <phrase>management</phrase> of the <phrase>botnet</phrase>, and gives clues as to the policy preferences of the botmaster to attack/not attack a given suite of networks or countries
Hosts performing DNS queries exhibited a random pattern of A queries
The TTL periods for the CnC domains was always <phrase>short</phrase>, meaning there was only a <phrase>short</phrase> <phrase>period</phrase> of time during which a stub query could be answered from cache, and not recorded at the authority
This behavior is typical of fast <phrase>flux</phrase> The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 17 networks
An increase in TTL from 60 to 360 seconds was identified, which signifies the cut over from the default zone TTL to the <phrase>SOA</phrase>
minimum used for wildcarded domains
Thus, the DDNS domains used in the attack appear to have been deregistered before December 18 and remained open for anyone in the world to register until the first week of January 2010
The <phrase>Malware</phrase> <phrase>Evolution</phrase> <phrase>Aurora</phrase> <phrase>malware</phrase> families date as far back as August of 2009
This <phrase>trail</phrase> helps determine the <phrase>evolution</phrase> and common characteristics of <phrase>malware</phrase> used by Operation <phrase>Aurora</phrase>, as well as a common <phrase>modus operandi</phrase> on the bot agents deployed as part of the attacks
The result is more than just an analysis of individual <phrase>malware</phrase> families
Rather, it helps profile the <phrase>criminal operators</phrase> behind <phrase>Aurora</phrase> via: <phrase>Malware</phrase> Delivery Method How does the <phrase>malware</phrase> get into the system? Is there a common delivery method or is it random? System Behavior Are the symptoms evident in the system common to all <phrase>Aurora</phrase> <phrase>malware</phrase> families or do they differ? Do the families use the same <phrase>infection</phrase> techniques, protection mechanisms and/or AV <phrase>evasion</phrase> techniques? Network Behavior Do the <phrase>malware</phrase> families exhibit the same network behavior? CnC Server Trials Powered by <phrase>Zero-Day</phrase> <phrase>Malware</phrase> Variants The table below lists significant events in the deployment and use of one of the <phrase>Aurora</phrase> <phrase>botnet</phrase> CnC servers known to the <phrase>public</phrase>, filoups
info, based on our <phrase>data</phrase> <phrase>mining</phrase> and analysis of <phrase>malware</phrase> samples and network traffic collected by Damballa
Several initial trials were conducted by the <phrase>botnet</phrase> operator prior to the <phrase>production</phrase> use of this CnC server
The first set of CnC domains appeared in a FakeAV <phrase>Trojan</phrase> <phrase>malware</phrase> family1-a in the beginning of May 2009
There were several variants of the family1 <phrase>malware</phrase> in the wild in 2009
The second set of CnC domains was used by a new family1-b <phrase>malware</phrase> variant in October 2009
By leveraging new <phrase>Zero-Day</phrase> <phrase>malware</phrase> variants, the <phrase>botnet</phrase> operator(s) could easily evade AV product detection and experiment with different CnC domain <phrase>construction</phrase> and <phrase>communication</phrase>
For example, different combinations of CnC domains were tried by both family1-c and family1-d <phrase>malware</phrase> variants in late October 2009
Finally, the CnC domain filoups
info was deployed and used by <phrase>malware</phrase> family1-<phrase>e</phrase> in November 2009
Domain mcsmc
org X X X X X thcway
info X X miecros
info X mnprfix
<phrase>cn</phrase> X micronetsys
org X filoups
info X MD5 family1-a family1-b family1-c family1-d family1-<phrase>e</phrase> Date 5/2/2009 8/18/2009 10/20/2009 10/22/2009 11/26/2009 Table 5: <phrase>Botnet</phrase> CnC trial <phrase>evolution</phrase> powered by <phrase>Zero-Day</phrase> <phrase>malware</phrase> variants
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 18 The family1-<phrase>e</phrase> <phrase>malware</phrase> is part of Fake AV Alert/<phrase>Scareware</phrase> <phrase>family</phrase> analyzed below
The behavior of Fake Alert/<phrase>Scareware</phrase> is quite similar to <phrase>Trojan</phrase>
Hydraq <phrase>malware</phrase> associated with the actual <phrase>Aurora</phrase> attacks, albeit in a much more primitive form
Sample Analysis Details The additional samples in Damballas possession that have been clustered as part of <phrase>Aurora</phrase> <phrase>botnet</phrase> <phrase>malware</phrase> can be separated into two distinct families of Fake AV Alert / <phrase>Scareware</phrase>: Login <phrase>Software</phrase> 2009 and <phrase>Microsoft</phrase> Antispyware Services
The first samples of each <phrase>family</phrase> were discovered by Damballa on November 26 2009 and August 19, 2009 respectively
The analysis details are broken down into the following: First Discovered The time when the sample was first discovered and acquired by Damballa
Prevalence The date <phrase>range</phrase> when the samples are still being seen in the wild by Damballa
<phrase>Infection</phrase> <phrase>Vector</phrase> How the samples are delivered to the unsuspecting victims
Symptoms <phrase>Observable</phrase> behaviors in the system that signals the possible presence of <phrase>malware</phrase> without actually looking at the registry or searching for the <phrase>malware</phrase> file itself
System Behavior How the <phrase>malware</phrase> works its way through the system to execute its objective
Network Behavior A detailed look at how the <phrase>malware</phrase> utilizes the domains it connects to
Protection Mechanism How the <phrase>malware</phrase> hides from the user or system inspection tools
AV <phrase>Evasion</phrase> Techniques How the <phrase>malware</phrase> protects itself from being detected by AV host solutions
Intent The main purpose of the <phrase>malware</phrase> <phrase>family</phrase> The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 19 Fake AV Alert / <phrase>Scareware</phrase> Login <phrase>Software</phrase> 2009 Fake <phrase>Microsoft</phrase> Antispyware Service Discovered 2009-11-26 2009-08-19 Prevalence November 2009 January 2010 August 2009 September 2009 <phrase>Infection</phrase> <phrase>Vector</phrase> Fake AV alerts on compromised or malicious Web sites Fake AV / <phrase>Scareware</phrase> Symptoms Login <phrase>Software</phrase> 2009 process in startup <phrase>Menu Bar</phrase> and <phrase>Toolbar</phrase> of <phrase>Internet Explorer</phrase> is missing System Restore is disabled Folder Options in <phrase>Windows Explorer</phrase> is disabled Extensions of known file types are hidden Registry Tools disabled, rendering registry <phrase>editing</phrase> inoperable Local Settings folder under C:\Documents and Settings\<User>\ (where the <phrase>malware</phrase> dropper places the dropped and downloaded executables) Presence of C:\Documents and Settings\<User>\<phrase>Windows</phrase>\system folder <phrase>Pop</phrase>-up ads Presence of tracking cookies and displays ads from: counter
surfcounters
com looksmart
com maxsun
biz moreverde
com oranges88
com smarttechnik
com www
prma-enhance
com <phrase>Microsoft</phrase> Antispyware Services process in startup System Behavior <phrase>Malware</phrase> propagates through fake <phrase>malware</phrase> alerts
The supposed AV installer is actually the <phrase>malware</phrase> dropper
Its main purpose is to drop and install the rest of the <phrase>malware</phrase> components
Upon execution, it assigns a specific ID to the compromised host, then <phrase>Malware</phrase> propagates through fake <phrase>malware</phrase> alerts
The supposed AV installer is actually the <phrase>malware</phrase> dropper
Its main purpose is to drop and install the rest of the <phrase>malware</phrase> components, typically: The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 20 registers it to its <phrase>malware</phrase> server Web site and downloads the rest of the <phrase>malware</phrase> to the compromised host
To ensure that the <phrase>malware</phrase> is downloaded, the creator of this <phrase>malware</phrase> dropper uses redundancy in its <phrase>malware</phrase> serving Web <phrase>infrastructure</phrase>
The dropper checks three different Web sites: mcsmc
org micronetsys
org mnprfix
<phrase>cn</phrase> When Damballa discovered this <phrase>malware</phrase> dropper in August 2009, the downloaded <phrase>executable</phrase> was version 0
The current version is 3
The functionalities remain similar
After the successful download of the main component, the main dropper generates a random name and copies the downloaded component to C:\Documents and Settings\<User>\Local Settings folder
It calls itself Login <phrase>Software</phrase> 2009
The dropped file is then executed to make it active in <phrase>memory</phrase>
It survives reboot by autostarting using a common registry entry: HKCU\<phrase>SOFTWARE</phrase>\<phrase>Microsoft</phrase>\<phrase>Windows</phrase>\CurrentVersion\Run The rest of the components must also be downloaded and executed for them to be active
They are placed in the same folder as the first dropped file
These components create exact copies of themselves with names varying from: debug
<phrase>exe</phrase> mqbxt
<phrase>exe</phrase> msinits
<phrase>exe</phrase> win16
<phrase>exe</phrase> winlogon
<phrase>exe</phrase> lsass
<phrase>exe</phrase> drweb
<phrase>exe</phrase> taskmgr
<phrase>exe</phrase> win32
<phrase>exe</phrase> <phrase>EXE</phrase> The component posing as <phrase>Microsoft</phrase> Antispyware Services VXD The main dropper downloads and installs ntconf32
vxd, ntsys32
vxd, msimsg32
vxd SYS The main dropper downloads and installs msconfig32
sys Once the dropper has executed, it can easily bypass UAC since it is given explicit permission by the user, who thought the installation was a real AV product
The first thing the dropper does is to connect to its <phrase>malware</phrase> server domain to download its components
The VXD components are often connected to <phrase>malware</phrase> families that have keylogging and <phrase>spyware</phrase> behavior
They are also found in some <phrase>IRC</phrase> bots
The SYS Component is related to the publicly known and notoriously popular <phrase>Aurora</phrase> variant tied to the <phrase>Google</phrase> attack
The <phrase>EXE</phrase> component disguises itself as <phrase>Microsoft</phrase> Antispyware Services
It <phrase>runs</phrase> on Startup using two <phrase>basic</phrase> registry keys: HKEY_LOCAL_MACHINE\<phrase>SOFTWARE</phrase>\<phrase>Microsoft</phrase>\<phrase>Windows</phrase>\CurrentVers <phrase>ion</phrase>\Run and HKEY_CURRENT_USER\<phrase>Software</phrase>\<phrase>Microsoft</phrase>\<phrase>Windows</phrase>\CurrentVersion\ Run This screen capture shows the dropper attempting to connect to <phrase>Amazon EC2</phrase>
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 21 These components are hidden from the user by hiding the folder where they are dropped and changing the attributes of the dropped files to hidden
To survive reboot, these components also are set to autostart using the same technique as the main dropped file
A <phrase>DLL</phrase> file is also dropped in C:\<phrase>Windows</phrase>\System32 with a random filename
Aside from registering (regsvr32
<phrase>exe</phrase>) the dropped <phrase>DLL</phrase> file to make it active, the <phrase>malware</phrase> dropper also modifies the registry to see it as a <phrase>Browser</phrase> Helper Object (BHO)
It also sets up the <phrase>DLL</phrase> to autostart every boot up by using SharedTaskScheduler: HKLM\<phrase>SOFTWARE</phrase>\<phrase>Microsoft</phrase>\<phrase>Windows</phrase>\CurrentVersion\Explorer\ SharedTaskScheduler This process paves the way for tracking cookies to be downloaded for ads to be served to the compromised host
This <phrase>DLL</phrase> is not hidden unlike the other components
After setting up all the dropped files, the main dropper protects the dropped files by manipulating the settings of <phrase>Windows Explorer</phrase> and <phrase>Internet Explorer</phrase>
See Protection Mechanism section for more details
Once all of these <phrase>malware</phrase> installation tasks are completed by the main dropper, the main dropper activates a <phrase>batch file</phrase> to unload itself from <phrase>memory</phrase> and deletes both the dropper and the <phrase>batch file</phrase>
The installed <phrase>malware</phrase> set is now all active and ready to communicate with CnC
This screen capture shows a <phrase>memory</phrase> string dump that reveals the CnC sought by the <phrase>EXE</phrase> <phrase>malware</phrase> component
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 22 This screen capture shows a <phrase>memory</phrase> string dump that reveals the CnC sought by the <phrase>EXE</phrase> <phrase>malware</phrase> component Network Behavior The <phrase>malware</phrase> uses domains for two purposes: a <phrase>malware</phrase> server domain that hosts the dropped executables and a CnC connection to listen for additional commands
The <phrase>malware</phrase> uses domains for two purposes: <phrase>malware</phrase> server domain that hosts the dropped executables and a CnC connection to listen for additional commands
This <phrase>malware</phrase> uses <phrase>Amazons</phrase> EC2 services to serve its <phrase>malware</phrase> components
<phrase>Malware</phrase> Server Domains mcsmc
org micronetsys
org mnprfix
<phrase>cn</phrase> ec2-79-125-21-42
<phrase>eu</phrase>-west-1
compute
amazonaws
com ip-173-201-21-161
ip
secureserver
net inekoncuba
inekon
co
cu The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 23 CnC Domains filoups
info miecros
info The dropped samples do not listen to the same CnC most of the time
Each listens to a different CnC using a different <phrase>port</phrase>
<phrase>google</phrase>
homeunix
com <phrase>yahoo</phrase>
blogdns
net voanews
<phrase>ath</phrase>
cx ymail
<phrase>ath</phrase>
cx Protection Mechanism The main dropper also utilizes <phrase>Malware</phrase> Self Preservation by doing the following before it self-destructs: Hides the location of the <phrase>malware</phrase> dropped files by setting the location folder as hidden and the dropped files themselves as hidden
 Disables Folder Options in <phrase>Windows Explorer</phrase> Disables Show hidden files and folders in <phrase>Windows Explorer</phrase> Hides <phrase>Internet</phrase> Explorers <phrase>Menu Bar</phrase> and <phrase>Toolbar</phrase> Disables System Restore Disables Registry <phrase>editing</phrase> None observed
AV <phrase>Evasion</phrase> Techniques No two dropped files are the same
The <phrase>malware</phrase> uses GetTickCount to generate random keys to randomize the hex structure of dropped files
One dropped file (273a51aada271e5a4a91321a3126c767) is packed using FSG v1
3
3
None observed
Intent <phrase>Money</phrase> generation through <phrase>pop</phrase>-up ads and Web site redirection Keylogging and <phrase>spyware</phrase>
MD5 <phrase>Information</phrase> Samples Collected/Discovered by Damballa ITW: 02677a0770268a20f7ef0d9bd7e8eef1 9803c22252a028b050f6257e7a67d4b7 69ef60094052321d91c0094efd832b92 6e245522d710ca1564e6873a3a0e82bd 0c091b4f6b23b450ccc3d37ccff6cdd6 994a379ff057724248d8435c9be45c1f b5b7146b07b0a0804b36b8056f316722 65510cda14bcefd2419eb1262a6d6829 Samples Collected/Discovered by Damballa ITW: a4a63756c39e345e31f1e8e698ea03a6 2794cacb3f177f340dee0aa2a71bdf1c 2f6c8d68392839cb4615c455cd25fc9c 20ddc972f71c8e584ed2c43254eb811b 1326879b25dd0d7452d7a4b674165a5a (*) denotes that no Rich signature present in the file (^) encrypted The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 24 01b9c2c916e6d9a82bfc5912348a231f 0b4872a4f20760739b0007c6b2dc08bd 253f59417c6c784d6c0e5565736d1815 273a51aada271e5a4a91321a3126c767*^ 325566e0871ac3d4fccfbb0b4efd8d07 38ee6476ffe7473707520ef7f5ed5ecb 62686fd8a1c24abfb7a621e5629ce4ab 69ef60094052321d91c0094efd832b92 6e245522d710ca1564e6873a3a0e82bd 73a88fa854e766d5d3e712db8291bcc8 863a096685354b2730ad9dfd7e91e942 b8a177d99854ccc71e94a4a6645e85e7 d112a2ed6c675158295acb4824b481d8 feb88ea662de113dcafbe45bdece82fc (*) denotes that no Rich signature present in the file (^) encrypted <phrase>Malware</phrase> Diagram The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 25 <phrase>Malware</phrase> Summary of Findings and Analysis The predecessor <phrase>Aurora</phrase> <phrase>malware</phrase> comes from two different families
The newer <phrase>family</phrase> came immediately 2 months after the older <phrase>family</phrase>, and there was no overlap in their prevalence
For the older <phrase>family</phrase>, there was neither an <phrase>observable</phrase> protection mechanism nor an AV <phrase>evasion</phrase> technique
It was simply a dropper for keylogger files
The newer <phrase>family</phrase> has some protection mechanisms and AV <phrase>evasion</phrase> techniques
However, it lacks the sophistication found in other <phrase>botnet</phrase> <phrase>malware</phrase> families
Below is a summary of the findings of the two <phrase>malware</phrase> families that were analyzed
Common characteristics: 1
Served through fake AV hosting Web sites (no longer available) 2
Common autostart techniques 3
Common older stealth techniques 4
Multiple <phrase>malware</phrase> server domains to improve resiliency 5
Droppers and dropped files (<phrase>EXE</phrase> and DLLs) were compiled using <phrase>Microsoft</phrase> compilers Differences: 1
Main <phrase>malware</phrase> component: a
November 2009 <phrase>Family</phrase> uses <phrase>DLL</phrase> file as one of its components b
August 2009 <phrase>Family</phrase> uses VXD and SYS files 2
Main <phrase>function</phrase>: a
November 2009 <phrase>Family</phrase> <phrase>pop</phrase>-up ads b
August 2009 <phrase>Family</phrase> Suspected keylogger (actual files are no longer available for analysis) 3
Protection Mechanism: a
November 2009 <phrase>Family</phrase> uses <phrase>basic</phrase> protection mechanisms to hide itself b
August 2009 <phrase>Family</phrase> none observed Comparing them to <phrase>Trojan</phrase>
Hydraq: 1
Code <phrase>obfuscation</phrase> <phrase>Trojan</phrase>
Hydraq uses <phrase>spaghetti code</phrase> in which program elements are separated into small chunks and connected via jump instructions
This technique complicates following the code, and is similar to the tactics employed in old PE <phrase>viruses</phrase> that write to small spaces in the host and connect themselves through jump instructions
 November 2009 <phrase>Family</phrase> Does not use any code <phrase>obfuscation</phrase>
One dropped file is actually packed using FSG v1
33
 August 2009 <phrase>Family</phrase> None observed
2
Autostart Technique <phrase>Trojan</phrase>
Hydraq uses Svchost process in <phrase>Windows</phrase> by adding its service name in netsvcs
When <phrase>Windows</phrase> starts, it will load the service into <phrase>memory</phrase>
 November 2009 <phrase>Family</phrase> Uses common autostart technique using the Run key
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 26 August 2009 <phrase>Family</phrase> Uses common autostart technique using the Run key
3
Intent / Payload <phrase>Trojan</phrase>
Hydraq <phrase>Information</phrase> gathering November 2009 <phrase>Family</phrase> Pops up ads and Web site redirector August 2009 <phrase>Family</phrase> <phrase>Information</phrase> gathering <phrase>Malware</phrase> Significance Basing on the profile of the two <phrase>malware</phrase> families that were analyzed, they are obviously different from each other
The key thing they have in common is that the CnC they utilize are publicly associated with the <phrase>Aurora</phrase> <phrase>botnet</phrase>
The <phrase>botnet</phrase> controllers preyed on the fear of users that their system is infected with <phrase>malware</phrase>
This method saves the <phrase>botnet</phrase> controllers from the technical complexity of bypassing <phrase>Windows</phrase> UAC by using the <phrase>weakest link</phrase> in host <phrase>security</phrase> which is the user
The misled user typically clicks <phrase>OK</phrase> to everything, bypassing UAC and giving the <phrase>malware</phrase> dropper explicit permission to execute
Neither of the <phrase>malware</phrase> predecessor families exhibit the sophistication found in newer <phrase>malware</phrase>
Some of the <phrase>evasion</phrase> techniques are almost a decade old
Both families use two sets of domains: one for serving <phrase>malware</phrase> and the other for CnC
The droppers and dropped files were compiled using <phrase>Microsoft</phrase> Compilers
This is evidenced by the presence of the string Rich before the PE header
This <phrase>watermark</phrase> is undocumented, meaning there is no mention of this <phrase>watermark</phrase> from <phrase>Microsoft</phrase> references but they are present in <phrase>binaries</phrase> compiled using <phrase>Microsoft</phrase> Compilers
Knowing the <phrase>compiler</phrase> of choice might help investigators narrow down the individuals or group of individuals responsible for the code
The simplicity and relative obsolescence of the early versions of the <phrase>Aurora</phrase> <phrase>malware</phrase> suggest that these <phrase>malware</phrase> families were created or written by an individual or group of individuals new to the <phrase>production</phrase> of commercial grade <phrase>malware</phrase>
Based solely on these families of malwares, it also appears that different individuals or group of individuals created the code: The only association the different families have with each other is that they used CnCs associated with Operation <phrase>Aurora</phrase>, and they were distributed via similar means
That said, it is possible that two different groups purchased the services of the same crimeware group (probably the same people behind Operation <phrase>Aurora</phrase>) to distribute and manage their <phrase>malware</phrase> <phrase>family</phrase>
Or the crimeware group rented out different variants of the same <phrase>malware</phrase> to different groups with different intentions
Price may also be a factor
The less resilient the <phrase>malware</phrase> <phrase>family</phrase> is, the cheaper it is to purchase or rent
 The intent of each <phrase>malware</phrase> <phrase>family</phrase> is different
 There is no natural progression seen between the two families
Usually <phrase>malware</phrase> writers evolve in both <phrase>technology</phrase> and protection of their creation but these two families did not show any related <phrase>evolution</phrase>
The <phrase>malware</phrase> families appear to exist independently, and then become superseded by <phrase>Trojan</phrase>
Hydraq
Piecing it Together Damballa analyzed network DNS <phrase>information</phrase> from a number of distinct and complementary sources ranging from global monitoring systems, enterprise monitoring sensors, passive DNS resolution <phrase>data</phrase> The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 27 and other DNS streams for this <phrase>report</phrase>
At the same time, Damballa also analyzed the <phrase>malware</phrase> commonly associated with the <phrase>Aurora</phrase> attacks disclosed by <phrase>Google</phrase> in January
The result has been a definite correlation between key CnC channels with other <phrase>malware</phrase> families that are associated with the <phrase>criminal operators</phrase> behind the <phrase>Aurora</phrase> <phrase>botnet</phrase>
Based upon our analysis of this attack and the surrounding evidence currently available, we classify the attacks against <phrase>Google</phrase> and the other previously identified victim organizations as being typical of current <phrase>botnet</phrase> criminal practices
The attack is most notable not for its advanced use of an <phrase>Internet Explorer 6</phrase> <phrase>Zero-Day</phrase> exploit, but rather for its unsophisticated <phrase>design</phrase> and a pedigree that points to a fast-learning but nevertheless <phrase>amateur</phrase> criminal <phrase>botnet</phrase> team
DDNS Findings Summary Based upon Damballas investigation of DDNS <phrase>data</phrase>, the key findings are as follows: 1
The <phrase>botnet</phrase> has a simple command <phrase>topology</phrase> and makes extensive use of DDNS CnC techniques
The <phrase>construction</phrase> of the <phrase>botnet</phrase> would be classed as old-<phrase>school</phrase>, and is rarely used by <phrase>professional</phrase> <phrase>botnet</phrase> <phrase>criminal operators</phrase> any more
However, such reliance upon DDNS CnC is commonly associated with new and <phrase>amateur</phrase> <phrase>botnet</phrase> operators 2
There were several CnC domains were identified based upon key characteristics of the registration and <phrase>management</phrase> of the previously publicly disclosed CnC domains
3
The <phrase>major</phrase> pattern of attacks in mid-December appear to have their origin in July 2009 in <phrase>mainland China</phrase>
This likely corresponds to early testing of the <phrase>botnet</phrase> CnC
4
Some of the infections appeared to start within Googles network
Some of apparent <phrase>botnet</phrase> the traffic is not consistent with an IE6/WinXP <phrase>infection</phrase> and cannot be easily explained
5
The attackers had access to large numbers of CnC hosts in geographically diverse hosting co- locations certainly a <phrase>high</phrase> number for a <phrase>botnet</phrase>
Further, the <phrase>botnet</phrase> used over a dozen domains in diverse DDNS networks for CnC
6
Only the US victims were compelled to perform <phrase>MX</phrase> queries, an event that would typically indicate attempted document exfiltration via <phrase>email</phrase> services
7
Some of the botnets focused on victims outside of <phrase>Google</phrase>, suggesting that each domain might have been dedicated to a distinct class or vertical of victims
8
A review of the TTL <phrase>period</phrase> suggests that botmasters de-registered their domains around December 18, 2009
Passive DNS <phrase>Data</phrase> Summary Based upon analysis of DNS resolution <phrase>data</phrase> gathered through a global network of passive DNS monitoring sensors, the key findings are as follows: 1
Cumulative volume of CnC domain name resolutions provides adequate sampling to identify the initialization and growth phases of the <phrase>Aurora</phrase> <phrase>botnet</phrase>, which also reveals active operation of the CnC channels dating back to June 14th 2009
2
The victims <phrase>computers</phrase> connected to, or were part of, 64 different networks, based upon Autonomous Systems (AS) breakdown of <phrase>Internet</phrase> netblocks which could represent the <phrase>upper</phrase> bound of organizations that may have been breached in the larger <phrase>Aurora</phrase> attack
Some organizations (such as <phrase>Google</phrase>) own and manage several AS networks
Some of the other AS networks were associated with <phrase>public</phrase> <phrase>Internet</phrase> <phrase>Service Providers</phrase>, which may encompass multiple small and medium businesses
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 28 3
The various CnC domains used by the criminal <phrase>botnet</phrase> operators peaked at different times with different rates of lookup by victim systems
These observations correspond to different campaigns run in parallel by different <phrase>botnet</phrase> operators and represent the widely publicized attacks that appeared to make use of the <phrase>Internet Explorer 6</phrase> <phrase>Zero-Day</phrase> exploit
It is a common tactic by <phrase>botnet</phrase> operators to run multiple campaigns at the same time, using different <phrase>infection</phrase> vectors (<phrase>e</phrase>
g
drive-by downloads, FakeAV, <phrase>USB</phrase> infections, etc
) over extended periods of time
This strategy is very consistent with APT campaign methodologies
4
The vast majority of victim systems appear to have been based in the <phrase>United States</phrase>
5
It is possible to identify the various CnC testing, deployment, <phrase>management</phrase> and shutdown phases of the <phrase>Aurora</phrase> <phrase>botnet</phrase> CnC channels
Some of the CnC domains appear to have been dormant for a <phrase>period</phrase> of time after they had infected number victim systems
This type of activity can sometimes be associated with an update to the <phrase>botnet</phrase> <phrase>malware</phrase> or if the criminal operator sells/trades a segment of the <phrase>botnet</phrase> to another criminal operator
<phrase>Malware</phrase> Analysis Summary Damballa has an array of sources for obtaining new and <phrase>Zero-Day</phrase> <phrase>malware</phrase> that <phrase>range</phrase> from commercial <phrase>security</phrase> sharing programs and spam traps to samples gathered from within its enterprise customers networks
By automatically analyzing tens-of-thousands of new and unique samples each day and extracting their CnC behaviors, Damballa can cluster these <phrase>malware</phrase> variants with different botnets
Based upon our analysis of <phrase>malware</phrase> samples that relied upon the <phrase>Aurora</phrase> CnC domains, our key findings are as follows: 1
The <phrase>botnet</phrase> operators behind the <phrase>Google</phrase> <phrase>Aurora</phrase> attacks deployed other <phrase>malware</phrase> families prior to the <phrase>Trojan</phrase>
Hydraq release
Some of these releases overlapped with each other
2
Two additional families of <phrase>malware</phrase> (and their <phrase>evolutionary</phrase> variants) were identified as Fake AV Alert / <phrase>Scareware</phrase> Login <phrase>Software</phrase> 2009 and Fake <phrase>Microsoft</phrase> Antispyware Service both of which were deployed using fake <phrase>antivirus</phrase> <phrase>infection</phrase> messages to socially <phrase>engineering</phrase> the victim into installing the malicious <phrase>botnet</phrase> agents
3
By tracking the <phrase>evolution</phrase> of the <phrase>malware</phrase>, Damballa was able to identify additional <phrase>botnet</phrase> CnC domains used by the <phrase>criminal operators</phrase> and establish a timeline of <phrase>malware</phrase> associations going back to May 2nd 2009, based upon when a <phrase>malware</phrase> sample was captured within an enterprise customer network
4
Over the time <phrase>period</phrase> of this study, the <phrase>botnet</phrase> operators improved upon the <phrase>malware</phrase> they were deploying
The relative sophistication and armoring of the <phrase>malware</phrase> families grow over the months the operators were deploying it, and when they transitioned to entirely new <phrase>malware</phrase> families
5
The <phrase>major</phrase> <phrase>malware</phrase> families associated with the <phrase>Aurora</phrase> <phrase>botnet</phrase> attacks are distinct and are unlikely to have been developed by the same <phrase>malware</phrase> <phrase>engineer</phrase>
This finding is typical of the botnets that Damballa observes targeting enterprise networks
Relatively few <phrase>botnet</phrase> <phrase>criminal operators</phrase> develop and maintain their own <phrase>malware</phrase>
Instead, they typically rely upon third- <phrase>party</phrase> contractors or off-the-shelf <phrase>malware</phrase> <phrase>construction</phrase> kits
As such, core features and functionality changes can occur overnight, but the CnC transitions slowly as the <phrase>botnet</phrase> operator ensures that backup CnC domains remain in operation until the victim <phrase>malware</phrase> updates (or migration) is complete
The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 29 Conclusions Damballas findings concerning Operation <phrase>Aurora</phrase> can be summarized by the following: At the time the attack was first noticed by <phrase>Google</phrase> in December 2009, systems within at least 7 countries had already been affected
By the time <phrase>Google</phrase> made the <phrase>public</phrase> disclosure of the attack on January 12 2010, systems in over 22 countries had been affected and were attempting to contact the CnC servers - the top five countries being the <phrase>United States</phrase>, <phrase>China</phrase>, <phrase>Germany</phrase>, <phrase>Taiwan</phrase> and the <phrase>United Kingdom</phrase>
 The <phrase>Trojan</phrase>
Hydraq <phrase>malware</phrase>, which has been previously identified as the primary <phrase>malware</phrase> used by the attackers, is actually a later staging of a series of <phrase>malware</phrase> used in the attacks which consisted of at least three different <phrase>malware</phrase> families
Two additional families of <phrase>malware</phrase> (and their <phrase>evolutionary</phrase> variants) have been identified, and they were deployed using fake <phrase>antivirus</phrase> <phrase>infection</phrase> messages tricking the victim into installing the malicious <phrase>botnet</phrase> agents
 The attacks that eventually targeted <phrase>Google</phrase> can be traced back to July 2009, with what appears to be the first testing of the <phrase>botnet</phrase> by its <phrase>criminal operators</phrase>
The analysis identifies the various CnC testing, deployment, <phrase>management</phrase> and shutdown phases of the <phrase>botnet</phrase> CnC channels
 The botnets used dozens of domains in diverse <phrase>Dynamic DNS</phrase> networks for CnC
Some of the botnets focused on victims outside of <phrase>Google</phrase>, suggesting that each set of domains might have been dedicated to a distinct class or vertical of victims
 Some of the CnC domains appear to have been dormant for a <phrase>period</phrase> of time after they had infected a number of victim systems
This can occur after the <phrase>botnet</phrase> operator has updated the <phrase>botnet</phrase> <phrase>malware</phrase> with new (more powerful) variants or when the criminal operator sells/trades a segment of the <phrase>botnet</phrase> to another criminal operator
 There were network artifacts that suggest that the <phrase>botnet</phrase> <phrase>malware</phrase> operating with the US-based victims networks made use of <phrase>email</phrase> services to extract the <phrase>stolen</phrase> <phrase>data</phrase> from the breached organizations
 There is evidence that there were multiple <phrase>criminal operators</phrase> involved, and that the <phrase>botnet</phrase> operators were of an <phrase>amateur</phrase> level
The <phrase>botnet</phrase> has a simple command <phrase>topology</phrase> and makes extensive use of <phrase>Dynamic DNS</phrase> CnC techniques
The <phrase>construction</phrase> of the <phrase>botnet</phrase> would be classed as old-<phrase>school</phrase>, and is rarely used by <phrase>professional</phrase> <phrase>botnet</phrase> <phrase>criminal operators</phrase> today Damballa was able to discover these details on Operation <phrase>Aurora</phrase> because of a different approach to researching and neutralizing botnets and other remote-controlled crimeware threats
Command-and- Control not <phrase>malware</phrase> or access point for the attack <phrase>vector</phrase> is the essential element for a successful <phrase>botnet</phrase> attack
Everything else about a <phrase>botnet</phrase> may change, but CnC must remain in place for the <phrase>botnet</phrase> to <phrase>act</phrase> in any sort of cohesive manner
Damballa is the only <phrase>company</phrase> that monitors detailed criminal CnC activity within enterprise networks and uses this focus to detect and sever malicious CnC communications
As a result, Damballa has been collecting CnC <phrase>data</phrase> for over 4 years, utilizing a globe-spanning array of network sensors within large enterprise customers and <phrase>Internet Service Provider</phrase> (<phrase>ISP</phrase>) customers
It is this deep visibility into Operation <phrase>Aurora</phrase> Cnc that revealed the details in this <phrase>report</phrase>
Although the methods used in Operation <phrase>Aurora</phrase> are amateurish and commonplace, the <phrase>results</phrase> were just as damaging as a sophisticated <phrase>botnet</phrase> because the threat was not quickly identified and neutralized
Auroras success proves that any breach by a <phrase>botnet</phrase> agent, regardless of the quality of the attack <phrase>vector</phrase>, is a dangerous <phrase>security</phrase> exposure
The result is always hidden and criminal remote The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 30 control of enterprise assets, with all of the legal, financial and reputational liabilities that accompany such a serious <phrase>security</phrase> lapse
Additional <phrase>Reading</phrase> How can I tell if I was infected by <phrase>aurora</phrase>, McAfee, 2010, http://www
mcafee
com/us/local_content/reports/how_can_u_tell
<phrase>pdf</phrase> Extracting CnC from <phrase>Malware</phrase>: The Role of <phrase>Malware</phrase> Sample Analysis in <phrase>Botnet</phrase> Detection, Damballa, 2009, http://www
damballa
com/downloads/r_pubs/WP_Malware_Samples_Botnet_Detection
<phrase>pdf</phrase> Serial Variant <phrase>Evasion</phrase> Tactics: Techniques Used to Automatically Bypass <phrase>Antivirus</phrase> Technologies, Damballa, 2009, http://www
damballa
com/downloads/r_pubs/WP_SerialVariantEvasionTactics
<phrase>pdf</phrase> <phrase>Botnet</phrase> <phrase>Communication</phrase> <phrase>Topologies</phrase>: Understanding the intricacies of <phrase>botnet</phrase> Command-and-Control, Damballa, 2009, http://www
damballa
com/downloads/r_pubs/WP_Botnet_Communications_Primer
<phrase>pdf</phrase> The <phrase>Botnet</phrase> vs
<phrase>Malware</phrase> Relationship: The One-to-One <phrase>Botnet</phrase> Myth, Damballa, 2009, http://www
damballa
com/downloads/d_pubs/WP_Botnet_vs_Malware
<phrase>pdf</phrase> MTrends: The <phrase>Advanced Persistent Threat</phrase>, Mandiant, 2010 <phrase>Google</phrase> <phrase>china</phrase> cyberattack part of vast <phrase>espionage</phrase> campaign, experts say, <phrase>Washington Post</phrase>, 2010, http://www
washingtonpost
com/wp-dyn/content/article/2010/01/13/AR2010011300359
<phrase>html</phrase> <phrase>Trojan</phrase>
hydraq, <phrase>Symantec</phrase>, 2010, http://www
<phrase>symantec</phrase>
com/security_response/writeup
jsp?docid=2010- 011114-1830-99 Contributors Manos Antonakakis Christopher Elisan <phrase>David</phrase> <phrase>Dagon</phrase> Gunter Ollmann Erik Wu The <phrase>Command Structure</phrase> of the <phrase>Aurora</phrase> <phrase>Botnet</phrase> Page 31 About Damballa, Inc
Damballa stops crimeware threats that exploit enterprise networks for illegal activity by finding and disrupting the hidden communications channels used to control internal servers and hosts
This concentrated focus on malicious <phrase>remote control</phrase> delivers fast, accurate insight into advanced network threats, including termination of criminal activity and remediation guidance
Damballas <phrase>technology</phrase> integrates easily with existing <phrase>infrastructure</phrase> for cost-effective protection against dangerous <phrase>security</phrase> breaches that evade other solutions
The result is smarter, more flexible network <phrase>security</phrase> that stops current and future threats, prevents <phrase>fiduciary</phrase> breaches and enhances <phrase>regulatory compliance</phrase>
Damballas customers include <phrase>major</phrase> <phrase>banks</phrase>, <phrase>Internet</phrase> <phrase>service providers</phrase>, <phrase>government</phrase> agencies, educational organizations, manufacturers and other organizations concerned with taking back the command-and-control of their networks
Privately held, Damballa is headquartered in <phrase>Atlanta</phrase>, GA
<phrase>Copyright</phrase> 2010, Damballa, Inc
All rights reserved worldwide
This page contains the most current <phrase>trademarks</phrase> for Damballa, Inc
, which include Damballa and the Damballa <phrase>logo</phrase>
The absence of a name or <phrase>logo</phrase> on this page does not constitute a waiver of any and all <phrase>intellectual property rights</phrase> that Damballa, Inc
has established in any of its <phrase>products</phrase>, services, names, or <phrase>logos</phrase>
All other marks are the <phrase>property</phrase> of their respective owners in their corresponding jurisdictions, and are used here in an editorial context, without intent of <phrase>infringement</phrase>
